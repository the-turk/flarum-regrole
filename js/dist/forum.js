module.exports=function(e){var o={};function t(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=o,t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var n in e)t.d(r,n,function(o){return e[o]}.bind(null,n));return r},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=16)}([function(e,o){e.exports=flarum.core.compat["forum/app"]},function(e,o){e.exports=flarum.core.compat["common/extend"]},function(e,o){e.exports=flarum.core.compat["common/utils/Stream"]},function(e,o){e.exports=flarum.core.compat["forum/components/SignUpModal"]},,,function(e,o){e.exports=flarum.core.compat["common/Model"]},function(e,o){e.exports=flarum.core.compat["common/components/Page"]},function(e,o){e.exports=flarum.core.compat["common/models/User"]},function(e,o){e.exports=flarum.core.compat["common/components/Button"]},function(e,o){e.exports=flarum.core.compat["forum/components/GroupBadge"]},function(e,o){e.exports=flarum.core.compat["common/utils/ItemList"]},function(e,o){e.exports=flarum.core.compat["common/components/Modal"]},,,,function(e,o,t){"use strict";t.r(o);var r=t(1),n=t(0),a=t.n(n),l=t(6),i=t.n(l),s=t(7),u=t.n(s),c=t(3),p=t.n(c),d=t(2),f=t.n(d),g=t(8),b=t.n(g);function h(e,o){return(h=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}var _=t(9),v=t.n(_),y=t(10),x=t.n(y),R=t(11),O=t.n(R),k=t(12),M=function(e){var o,t;function r(){return e.apply(this,arguments)||this}t=e,(o=r).prototype=Object.create(t.prototype),o.prototype.constructor=o,h(o,t);var n=r.prototype;return n.oninit=function(o){e.prototype.oninit.call(this,o),this.regRoleIds=f()([])},n.className=function(){return"Modal--small ChooseRoleModal"},n.title=function(){return app.translator.trans("the-turk-regrole.forum.choose_role_modal.choose_role_heading")},n.content=function(){return[m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},this.fields().toArray())),m("div",{className:"Modal-footer"},m("p",null,app.translator.trans("the-turk-regrole.forum.choose_role_modal.choose_role_text")))]},n.roleField=function(){var e=this;return m("div",{className:"Form-group regRole-group"},m("label",{className:"regRole-label"},app.translator.trans("the-turk-regrole.forum.sign_up_modal.choose_role_heading")),m("div",{className:"regRole-container"},app.forum.attribute("regrole.available_roles").map((function(o){return m("div",{className:"regRole-item"},m("label",null,m("div",{className:"regRole-badge"},x.a.component({icon:o.icon,style:{backgroundColor:o.color},label:null,type:"group--"+o.id})),m("input",{type:"checkbox",className:"regRole-input",name:"regRole[]",onchange:function(t){var r=e.regRoleIds().indexOf(o.id),n=t.target.checked;app.forum.attribute("regrole.allow_multiple_roles")?n&&-1===r?e.regRoleIds().push(o.id):!n&&r>-1&&e.regRoleIds().splice(r,1):e.regRoleIds(n?[o.id]:[])},disabled:e.loading}),o.name_singular))}))))},n.fields=function(){var e=new O.a;return e.add("registration-roles",this.roleField(),10),e.add("submit",m("div",{className:"Form-group"},m(v.a,{className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("the-turk-regrole.forum.choose_role_modal.save_button"))),-10),e},n.onsubmit=function(e){var o=this;e.preventDefault(),this.loading=!0,app.request({url:app.forum.attribute("apiUrl")+"/regrole",method:"POST",body:{regrole_role_ids:this.regRoleIds()},errorHandler:this.onerror.bind(this)}).then((function(){window.location.reload()})).catch((function(){o.loaded()}))},r}(t.n(k).a);a.a.initializers.add("the-turk-regrole",(function(){b.a.prototype.regRole_allGroups=i.a.hasMany("regrole_all_groups"),Object(r.extend)(u.a.prototype,"oninit",(function(){var e=$("body");if(a.a.forum.attribute("regrole.force_users")){var o=a.a.session.user,t=a.a.forum.attribute("regrole.suspended_actor");if(o&&!t&&!1===o.canEditGroups()){var r,n,l,i=a.a.forum.attribute("regrole.allowed_role_ids"),s=(null==(r=o.data)||null==(n=r.relationships)||null==(l=n.groups)?void 0:l.data)||[],u=[];if(s&&Array.isArray(s)&&s.length&&s.forEach((function(e){null!=e&&e.type&&null!=e&&e.id&&"groups"===e.type&&u.push(e.id)})),!(u&&u.filter((function(e){return i.indexOf(e)>-1})).length)){setTimeout((function(){return a.a.modal.show(M,{user:o})}),0);if(!$(".RegRole-alert").length){var c='\n                <div class="Alert Alert--warning RegRole-alert">\n                  <span class="Alert-body">\n                    '+a.a.translator.trans("the-turk-regrole.forum.suspended_temporarily_message")+'\n                  </span>\n                  <ul class="Alert-controls">\n                    <li>\n                      <button class="Button Button--link">\n                        <span class="Button-label">\n                            '+a.a.translator.trans("the-turk-regrole.forum.choose_role_button_label")+"\n                        </span>\n                      </button>\n                    </li>\n                  </ul>\n                </div>\n              ";$("#header, #app-navigation").append(c),e.on("click",".RegRole-alert button",(function(){return a.a.modal.show(M,{user:o})}))}}}}e.on("click",".SignUpModal .regRole-input, .ChooseRoleModal .regRole-input",(function(){var e=$(this).closest(".regRole-item");e.hasClass("active")?e.removeClass("active"):(e.addClass("active"),a.a.forum.attribute("regrole.allow_multiple_roles")||(e.siblings().removeClass("active"),e.siblings().find("input[type=checkbox]").prop("checked",!1)))}))})),Object(r.extend)(p.a.prototype,"oninit",(function(){this.regRoleIds=f()([])})),Object(r.extend)(p.a.prototype,"fields",(function(e){e.add("registration-roles",M.prototype.roleField.bind(this)(),9)})),Object(r.extend)(p.a.prototype,"submitData",(function(e){e.regrole_role_ids=this.regRoleIds()}))}))}]);
//# sourceMappingURL=forum.js.map
